{
  "title": "Unpack the Visits",
  "description": "Discovering visit patterns with WHERE and IN clauses",
  "estimated_minutes": 45,
  "priority": 0,
  "dependencies": ["Dive into Water Sources"],
  "learning_objectives": [
    {
      "level": "apply",
      "description": "Apply WHERE clauses to filter data based on conditions"
    },
    {
      "level": "apply",
      "description": "Apply the IN operator to check multiple values"
    },
    {
      "level": "evaluate",
      "description": "Evaluate the real-world impact of long queue times"
    }
  ],
  "content": "We have a table in our database that logs the visits made to different water sources. Can you identify this table? The 'visits' table in our database is like a logbook of all the trips made to different water sources. We need to unravel this logbook to understand the frequency and distribution of these visits.",
  "tasks": [
    {
      "title": "Find locations with long queue times",
      "description": "Use WHERE to filter visits where people queue for extremely long times",
      "estimated_minutes": 20,
      "priority": 0,
      "learning_objectives": [
        {
          "level": "apply",
          "description": "Apply WHERE with comparison operators"
        },
        {
          "level": "evaluate",
          "description": "Evaluate what extreme queue times mean for communities"
        }
      ],
      "content": "Write an SQL query that retrieves all records from this table where the time_in_queue is more than some crazy time, say 500 min. How would it feel to queue 8 hours for water?",
      "subtasks": [
        {
          "title": "Consider the human impact of long queues",
          "subtask_type": "conversational",
          "description": "Reflect on what 500+ minutes of queue time means for real people",
          "estimated_minutes": 5,
          "content": "Before we write the query, think about this: 500 minutes is over 8 hours. Imagine queueing 8 hours for water. What would that mean for:\n- A parent trying to feed their family?\n- Children who should be in school?\n- Workers who need to earn a living?\n\nThis data isn't just numbers - it represents real hardship.",
          "learning_objectives": [
            {
              "level": "evaluate",
              "description": "Evaluate the real-world significance of queue time data"
            }
          ],
          "tutor_guidance": {
            "teaching_approach": "Connect the technical query to human impact before writing code",
            "discussion_prompts": [
              "How is this possible? Can you imagine queueing 8 hours for water?",
              "What activities would you miss if you had to queue this long?",
              "Who in a family typically has to do this waiting?"
            ]
          }
        },
        {
          "title": "Write WHERE query for long queues",
          "subtask_type": "exercise",
          "description": "Filter visits where time_in_queue exceeds 500 minutes",
          "estimated_minutes": 10,
          "dependencies": ["Consider the human impact of long queues"],
          "acceptance_criteria": "- Query uses SELECT * FROM visits WHERE time_in_queue > 500\n- Student can see the results showing extreme queue times\n- Student notices the visit_count column shows multiple visits",
          "content": "Write a query to find all visits where people queued more than 500 minutes:\n\n**Expected query:**\n```sql\nSELECT *\nFROM visits\nWHERE time_in_queue > 500\n```\n\nThis is the table I get:\n\n| record_id | location_id | source_id | time_of_record | visit_count | time_in_queue | assigned_employee_id |\n|-----------|-------------|-----------|----------------|-------------|---------------|----------------------|\n| 899 | SoRu35083 | SoRu35083224 | 2021-01-16 10:14:00 | 6 | 515 | 28 |\n| 2304 | SoKo33124 | SoKo33124224 | 2021-02-06 07:53:00 | 5 | 512 | 16 |\n| 2315 | KiRu26095 | KiRu26095224 | 2021-02-06 14:32:00 | 3 | 529 | 8 |\n\nHow is this possible? Can you imagine queueing 8 hours for water?",
          "learning_objectives": [
            {
              "level": "apply",
              "description": "Apply WHERE with greater-than comparison"
            }
          ],
          "tutor_guidance": {
            "answer_rationale": "WHERE time_in_queue > 500 filters to only rows where the queue time exceeds 500 minutes",
            "hints_to_give": [
              "Use > for 'greater than' comparison",
              "time_in_queue is measured in minutes"
            ]
          }
        }
      ]
    },
    {
      "title": "Investigate which source types have long queues",
      "description": "Use IN to look up source types for locations with extreme queue times",
      "estimated_minutes": 25,
      "priority": 0,
      "dependencies": ["Find locations with long queue times"],
      "learning_objectives": [
        {
          "level": "apply",
          "description": "Apply the IN operator to check multiple values"
        },
        {
          "level": "analyze",
          "description": "Analyze patterns between source types and queue times"
        }
      ],
      "content": "I am wondering what type of water sources take this long to queue for. We will have to find that information in another table that lists the types of water sources. If I remember correctly, the table has type_of_water_source, and a source_id column. So let's write down a couple of these source_id values from our results, and search for them in the other table.",
      "subtasks": [
        {
          "title": "Note source IDs to investigate",
          "subtask_type": "conversational",
          "description": "Identify source_id values from the long queue results to look up",
          "estimated_minutes": 5,
          "content": "From our results, let's note some source_id values to investigate:\n\nFrom the long queue results:\n- AkKi00881224\n- SoRu37635224\n- SoRu36096224\n\nIf we just select the first couple of records of the visits table without a WHERE filter, we can see that some of these rows also have 0 mins queue time. So let's write down one or two of these too:\n- AkRu05234224\n- HaZa21742224",
          "learning_objectives": [
            {
              "level": "understand",
              "description": "Understand how to cross-reference data between tables"
            }
          ]
        },
        {
          "title": "Use IN to look up multiple source IDs",
          "subtask_type": "exercise",
          "description": "Write a query using IN to check multiple source_ids in the water_source table",
          "estimated_minutes": 15,
          "dependencies": ["Note source IDs to investigate"],
          "acceptance_criteria": "- Query uses WHERE source_id IN(...) with multiple values\n- Student can see that shared_tap sources have the long queues\n- Student understands IN as an alternative to multiple OR conditions",
          "content": "Ok, so now back to the water_source table. Let's check the records for those source_ids. You can probably remember there is a cool and a \"not so cool\" way to do it.\n\n**Expected query:**\n```sql\nSELECT *\nFROM water_source\nWHERE source_id IN(\n    'AkRu05234224',\n    'AkKi00881224',\n    'SoRu37635224',\n    'SoRu36096224',\n    'HaZa21742224',\n    'AkLu01628224',\n    'SoRu38776224'\n)\n```\n\nThis is what I get:\n\n| source_id | type_of_water_source | number_of_people_served |\n|-----------|----------------------|-------------------------|\n| AkKi00881224 | shared_tap | 3398 |\n| AkLu01628224 | bio_dirty_well | 210 |\n| AkRu05234224 | tap_in_home_broken | 496 |\n| HaRu19601224 | shared_tap | 3322 |\n| HaZa21742224 | pol_dirty_well | 308 |\n| SoRu36096224 | shared_tap | 3786 |\n| SoRu37635224 | shared_tap | 3920 |\n\nI added a couple of others... Sorry! Well, if you check them you will see which sources have people queueing. The field surveyors also let us know that they measured sources that had queues a few times to see if the queue time changed.",
          "learning_objectives": [
            {
              "level": "apply",
              "description": "Apply IN operator for multiple value matching"
            },
            {
              "level": "analyze",
              "description": "Analyze patterns between source types and queue times"
            }
          ],
          "tutor_guidance": {
            "answer_rationale": "Using IN is more elegant than multiple OR conditions. The results show that shared_tap sources are the ones with extreme queue times - they serve thousands of people!",
            "common_mistakes": [
              "Forgetting quotes around string values",
              "Using = instead of IN for multiple values"
            ],
            "hints_to_give": [
              "IN lets you check if a value matches any in a list",
              "It's cleaner than writing source_id = 'x' OR source_id = 'y' OR..."
            ]
          }
        }
      ]
    }
  ]
}
