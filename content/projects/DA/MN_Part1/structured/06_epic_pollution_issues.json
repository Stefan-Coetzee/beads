{
  "title": "Pollution Issues Investigation",
  "description": "Correcting pollution data with LIKE, UPDATE, and safe modification practices",
  "estimated_minutes": 90,
  "priority": 0,
  "dependencies": ["Water Source Quality Assessment"],
  "learning_objectives": [
    {
      "level": "apply",
      "description": "Apply LIKE operator for pattern matching in text data"
    },
    {
      "level": "apply",
      "description": "Apply UPDATE statements to correct data errors"
    },
    {
      "level": "create",
      "description": "Create safe data modification workflows using backup tables"
    },
    {
      "level": "evaluate",
      "description": "Evaluate data integrity by finding contradictory records"
    }
  ],
  "content": "Did you notice that we recorded contamination/pollution data for all of the well sources? Find the right table and print the first few rows.",
  "tasks": [
    {
      "title": "Explore the well_pollution table",
      "description": "Examine contamination data for wells",
      "estimated_minutes": 15,
      "priority": 0,
      "learning_objectives": [
        {
          "level": "understand",
          "description": "Understand the well_pollution table and contamination measurements"
        }
      ],
      "content": "Let's find and explore the well pollution data.",
      "subtasks": [
        {
          "title": "Query the well_pollution table",
          "subtask_type": "exercise",
          "description": "View the structure and sample data from well_pollution",
          "estimated_minutes": 10,
          "acceptance_criteria": "- Query retrieves first few rows from well_pollution\n- Student can identify columns: source_id, date, description, pollutant_ppm, biological, results\n- Student understands that biological > 0.01 means contaminated",
          "content": "Find the right table and print the first few rows.\n\n**Expected query:**\n```sql\nSELECT *\nFROM well_pollution\n```\n\nI get this:\n\n| source_id | date | description | pollutant_ppm | biological | results |\n|-----------|------|-------------|---------------|------------|--------|\n| KiRu28935224 | 2021-01-04 09:17:00 | Bacteria: Giardia Lamblia | 0.0 | 495.898 | Contaminated: Biological |\n| AkLu01628224 | 2021-01-04 09:53:00 | Bacteria: Salmonella Typhi | 0.0 | 376.572 | Contaminated: Biological |\n| HaZa21742224 | 2021-01-04 10:37:00 | Inorganic contaminants: Zinc... | 2.715 | 0.0 | Contaminated: Chemical |\n| HaRu19725224 | 2021-01-04 11:04:00 | Clean | 0.0288593 | 0.0 | Clean |\n| SoRu35703224 | 2021-01-04 11:29:00 | Bacteria: E. coli | 0.0 | 296.437 | Contaminated: Biological |\n\nIt looks like our scientists diligently recorded the water quality of all the wells. Some are contaminated with biological contaminants, while others are polluted with an excess of heavy metals and other pollutants. Based on the results, each well was classified as Clean, Contaminated: Biological or Contaminated: Chemical. It is important to know this because wells that are polluted with bio- or other contaminants are not safe to drink. It looks like they recorded the source_id of each test, so we can link it to a source, at some place in Maji Ndogo.",
          "learning_objectives": [
            {
              "level": "understand",
              "description": "Understand pollution data structure and contamination thresholds"
            }
          ],
          "tutor_guidance": {
            "teaching_approach": "Emphasize the health implications - this data determines if water is safe to drink",
            "hints_to_give": [
              "biological column is in CFU/mL - 0 is clean, > 0.01 is contaminated",
              "The results column should match the biological readings"
            ]
          }
        }
      ]
    },
    {
      "title": "Find data contradictions",
      "description": "Identify wells marked as Clean but with biological contamination",
      "estimated_minutes": 20,
      "priority": 0,
      "dependencies": ["Explore the well_pollution table"],
      "learning_objectives": [
        {
          "level": "analyze",
          "description": "Analyze data for dangerous contradictions"
        }
      ],
      "content": "In the well pollution table, the descriptions are notes taken by our scientists as text, so it will be challenging to process it. The biological column is in units of CFU/mL, so it measures how much contamination is in the water. 0 is clean, and anything more than 0.01 is contaminated.\n\nLet's check the integrity of the data. The worst case is if we have contamination, but we think we don't. People can get sick, so we need to make sure there are no errors here.",
      "subtasks": [
        {
          "title": "Discuss the health implications of mislabeled wells",
          "subtask_type": "conversational",
          "description": "Understand why finding 'Clean' wells with contamination is dangerous",
          "estimated_minutes": 5,
          "content": "Think about the danger here: if a well is marked as 'Clean' in the results column, but actually has biological contamination (biological > 0.01), people will drink contaminated water thinking it's safe.\n\nThis is potentially a life-threatening data error. We MUST find and fix these records.",
          "learning_objectives": [
            {
              "level": "evaluate",
              "description": "Evaluate the real-world danger of data errors"
            }
          ]
        },
        {
          "title": "Query for contradictory records",
          "subtask_type": "exercise",
          "description": "Find wells where results='Clean' but biological > 0.01",
          "estimated_minutes": 10,
          "dependencies": ["Discuss the health implications of mislabeled wells"],
          "acceptance_criteria": "- Query returns rows where results='Clean' AND biological > 0.01\n- Uses WHERE with AND to combine both conditions\n- Student understands why these records are dangerous",
          "content": "So, write a query that checks if the results is Clean but the biological column is > 0.01.\n\n**Expected query:**\n```sql\nSELECT *\nFROM well_pollution\nWHERE results = 'Clean'\nAND biological > 0.01\n```\n\nI got this:\n\n| source_id | date | description | pollutant_ppm | biological | results |\n|-----------|------|-------------|---------------|------------|--------|\n| AkRu08936224 | 2021-01-08 09:22:00 | Bacteria: E. coli | 0.0406458 | 35.0068 | Clean |\n| AkRu06489224 | 2021-01-10 09:44:00 | Clean Bacteria: Giardia Lamblia | 0.0897904 | 38.467 | Clean |\n| SoRu38011224 | 2021-01-14 15:35:00 | Bacteria: E. coli | 0.0425095 | 19.2897 | Clean |\n\nIf we compare the results of this query to the entire table it seems like we have some inconsistencies in how the well statuses are recorded. Specifically, it seems that some data input personnel might have mistaken the description field for determining the cleanliness of the water.",
          "learning_objectives": [
            {
              "level": "analyze",
              "description": "Analyze data for contradictory values"
            }
          ],
          "tutor_guidance": {
            "answer_rationale": "If results = 'Clean' the description is saying the well is clean, but AND biological > 0.01 says it is polluted. So this query finds the records that say clean, but are actually dirty."
          }
        }
      ]
    },
    {
      "title": "Use LIKE for pattern matching",
      "description": "Find descriptions with extra 'Clean' prefix using wildcards",
      "estimated_minutes": 15,
      "priority": 0,
      "dependencies": ["Find data contradictions"],
      "learning_objectives": [
        {
          "level": "apply",
          "description": "Apply LIKE operator with wildcards for pattern matching"
        }
      ],
      "content": "It seems like, in some cases, if the description field begins with the word 'Clean', the results have been classified as 'Clean' in the results column, even though the biological column is > 0.01.\n\nWe need to find and remove the 'Clean' part from all the descriptions that do have a biological contamination so this mistake is not made again.",
      "subtasks": [
        {
          "title": "Understand the error pattern",
          "subtask_type": "conversational",
          "description": "Understand why some descriptions have 'Clean' prefix incorrectly",
          "estimated_minutes": 5,
          "content": "Vuyisile has told me that the descriptions should only have the word 'Clean' if there is no biological contamination (and no chemical pollutants). Some data personnel must have copied the data from the scientist's notes into our database incorrectly. We need to find and remove the 'Clean' part from all the descriptions that do have a biological contamination so this mistake is not made again.\n\nFirst, let's look at the descriptions. We need to identify the records that mistakenly have the word Clean in the description. However, it is important to remember that not all of our field surveyors used the description to set the results - some checked the actual data.",
          "learning_objectives": [
            {
              "level": "understand",
              "description": "Understand the root cause of data entry errors"
            }
          ]
        },
        {
          "title": "Write LIKE query for wrong descriptions",
          "subtask_type": "exercise",
          "description": "Use LIKE with wildcards to find descriptions starting with 'Clean' followed by other text",
          "estimated_minutes": 10,
          "dependencies": ["Understand the error pattern"],
          "acceptance_criteria": "- Query uses LIKE 'Clean_%' pattern\n- Returns 38 wrong descriptions\n- Student understands _ matches one character and % matches any characters",
          "content": "**Hint:** To find these descriptions, search for the word Clean with additional characters after it. As this is what separates incorrect descriptions from the records that should have 'Clean'.\n\n**Expected query:**\n```sql\nSELECT *\nFROM well_pollution\nWHERE description LIKE 'Clean_%'\n```\n\nThe query should return 38 wrong descriptions.\n\nLooking at the results we can see two different descriptions that we need to fix:\n1. All records that mistakenly have 'Clean Bacteria: E. coli' should be updated to 'Bacteria: E. coli'\n2. All records that mistakenly have 'Clean Bacteria: Giardia Lamblia' should be updated to 'Bacteria: Giardia Lamblia'\n\nThe second issue we need to fix is in our results column. We need to update the results column from 'Clean' to 'Contaminated: Biological' where the biological column has a value greater than 0.01.",
          "learning_objectives": [
            {
              "level": "apply",
              "description": "Apply LIKE with wildcard patterns"
            }
          ],
          "tutor_guidance": {
            "answer_rationale": "'Clean_%' means it starts with 'Clean', (_) have at least one character after 'Clean' and (%) can have any other characters after that.",
            "common_mistakes": [
              "Forgetting the quotes around the pattern",
              "Using * instead of %",
              "Using LIKE = instead of just LIKE"
            ]
          }
        }
      ]
    },
    {
      "title": "Safely update the data",
      "description": "Use a copy table to safely test and apply UPDATE statements",
      "estimated_minutes": 40,
      "priority": 0,
      "dependencies": ["Use LIKE for pattern matching"],
      "learning_objectives": [
        {
          "level": "create",
          "description": "Create safe data modification workflows"
        },
        {
          "level": "apply",
          "description": "Apply UPDATE statements to correct data"
        }
      ],
      "content": "Now we need to fix these descriptions so that we don't encounter this issue again in the future. But when we change any data on the database, we need to be SURE there are no errors, as this could fill the database with incorrect values.",
      "subtasks": [
        {
          "title": "Discuss the responsibility of modifying data",
          "subtask_type": "conversational",
          "description": "Understand the risks and best practices for UPDATE statements",
          "estimated_minutes": 5,
          "content": "Before we make any changes, here is another nugget of advice: Begin complex queries by commenting on what you will do. This helps us to think through the problem before we write code to solve it, and once we're done, we have a well-documented code.\n\nNow, when we change any data on the database, we need to be SURE there are no errors, as this could fill the database with incorrect values. A safer way to do the UPDATE is by testing the changes on a copy of the table first.",
          "learning_objectives": [
            {
              "level": "understand",
              "description": "Understand the importance of safe data modification practices"
            }
          ],
          "tutor_guidance": {
            "teaching_approach": "Emphasize this as a professional best practice that prevents disasters",
            "discussion_prompts": [
              "What if your WHERE clause accidentally matched more rows than intended?",
              "How would you undo an UPDATE if you made a mistake?",
              "Why might companies have 'read-only' vs 'read-write' database permissions?"
            ]
          }
        },
        {
          "title": "Create a copy table for safe testing",
          "subtask_type": "exercise",
          "description": "Create well_pollution_copy to test UPDATE queries",
          "estimated_minutes": 5,
          "dependencies": ["Discuss the responsibility of modifying data"],
          "acceptance_criteria": "- Copy table well_pollution_copy created successfully\n- Contains same data as original well_pollution table\n- Student understands why testing on a copy is essential",
          "content": "The CREATE TABLE new_table AS (query) approach is a neat trick that allows you to create a new table from the results set of a query. This method is especially useful for creating backup tables or subsets without the need for a separate CREATE TABLE and INSERT INTO statement.\n\nSo if we run:\n\n**Expected query:**\n```sql\nCREATE TABLE well_pollution_copy AS (\n    SELECT *\n    FROM well_pollution\n)\n```\n\nWe will get a copy of well_pollution called well_pollution_copy. Now we can make the changes, and if we discover there is a mistake in our code, we can just delete this table, and run it again.",
          "learning_objectives": [
            {
              "level": "apply",
              "description": "Apply CREATE TABLE AS SELECT to create backup copies"
            }
          ],
          "tutor_guidance": {
            "teaching_approach": "Emphasize this as a professional best practice",
            "hints_to_give": [
              "Always make a copy before modifying production data",
              "Test your UPDATE on the copy first"
            ]
          }
        },
        {
          "title": "Write UPDATE queries for the copy table",
          "subtask_type": "exercise",
          "description": "Write and test UPDATE queries on the copy table",
          "estimated_minutes": 15,
          "dependencies": ["Create a copy table for safe testing"],
          "acceptance_criteria": "- All three UPDATE queries written correctly\n- Updates tested on well_pollution_copy first\n- Student can explain what each UPDATE does",
          "content": "So if we now run our query on the copy table:\n\n**Case 1a - Fix E. coli descriptions:**\n```sql\nUPDATE well_pollution_copy\nSET description = 'Bacteria: E. coli'\nWHERE description = 'Clean Bacteria: E. coli'\n```\n\n**Case 1b - Fix Giardia descriptions:**\n```sql\nUPDATE well_pollution_copy\nSET description = 'Bacteria: Giardia Lamblia'\nWHERE description = 'Clean Bacteria: Giardia Lamblia'\n```\n\n**Case 2 - Fix results column:**\n```sql\nUPDATE well_pollution_copy\nSET results = 'Contaminated: Biological'\nWHERE biological > 0.01 AND results = 'Clean'\n```",
          "learning_objectives": [
            {
              "level": "create",
              "description": "Create UPDATE statements with WHERE conditions"
            }
          ],
          "tutor_guidance": {
            "answer_rationale": "Case 1a and 1b fix the description field by removing the erroneous 'Clean ' prefix. Case 2 fixes the results column by setting it to 'Contaminated: Biological' where the data shows contamination but was incorrectly marked as Clean."
          }
        },
        {
          "title": "Verify the fixes worked",
          "subtask_type": "exercise",
          "description": "Run a verification query to confirm all errors are fixed",
          "estimated_minutes": 5,
          "dependencies": ["Write UPDATE queries for the copy table"],
          "acceptance_criteria": "- Verification query returns 0 rows\n- Student understands how to verify data corrections",
          "content": "We can then check if our errors are fixed using a SELECT query on the well_pollution_copy table:\n\n**Expected query:**\n```sql\nSELECT *\nFROM well_pollution_copy\nWHERE description LIKE 'Clean_%'\nOR (results = 'Clean' AND biological > 0.01)\n```\n\nThis should return 0 rows if all our fixes worked correctly.",
          "learning_objectives": [
            {
              "level": "evaluate",
              "description": "Evaluate the success of data corrections"
            }
          ]
        },
        {
          "title": "Apply updates to production and cleanup",
          "subtask_type": "exercise",
          "description": "Apply the verified updates to the real table and drop the copy",
          "estimated_minutes": 10,
          "dependencies": ["Verify the fixes worked"],
          "acceptance_criteria": "- Updates applied to well_pollution table\n- Copy table dropped with DROP TABLE\n- Student understands the complete safe modification workflow",
          "content": "Then if we're sure it works as intended, we can change the table back to the well_pollution and delete the well_pollution_copy table.\n\n```sql\nUPDATE well_pollution\nSET description = 'Bacteria: E. coli'\nWHERE description = 'Clean Bacteria: E. coli';\n\nUPDATE well_pollution\nSET description = 'Bacteria: Giardia Lamblia'\nWHERE description = 'Clean Bacteria: Giardia Lamblia';\n\nUPDATE well_pollution\nSET results = 'Contaminated: Biological'\nWHERE biological > 0.01 AND results = 'Clean';\n\nDROP TABLE well_pollution_copy;\n```\n\nSo I hope that today helped you to see what the survey data is all about. I hope that you are as excited as I am to get stuck in! Until then, keep well!",
          "learning_objectives": [
            {
              "level": "apply",
              "description": "Apply DROP TABLE to clean up temporary tables"
            }
          ],
          "tutor_guidance": {
            "teaching_approach": "End on a high note - connect their work to meaningful outcomes",
            "discussion_prompts": [
              "How has your view of 'data analysis' changed?",
              "What would you do differently if you encountered messy data again?",
              "Why does careful, verified work matter more than fast work?"
            ]
          }
        }
      ]
    }
  ]
}
